{"version":3,"file":"modifiers.mjs","sources":["../../src/core/modifiers.ts"],"sourcesContent":["import { ChalkeeBase } from './ChalkeeBase'\r\nimport { createStyleState } from \"./styler\"\r\nimport { type Chalkee, createStyledFunction } from './Chalkee'\r\nimport { setModifierLookup } from './styler'\r\n\r\n// ANSI modifier codes\r\nexport const ANSI_MODIFIERS: Record<string, number> = {\r\n    reset: 0,\r\n    bold: 1,\r\n    dim: 2,\r\n    italic: 3,\r\n    underline: 4,\r\n    inverse: 7,\r\n    hidden: 8,\r\n    strikethrough: 9,\r\n}\r\n\r\n/**\r\n * Get ANSI code for a modifier\r\n * @param modifierName The name of the modifier\r\n * @returns The ANSI modifier code or undefined if not found\r\n */\r\nexport function getModifier(modifierName: string): number | undefined {\r\n    return ANSI_MODIFIERS[modifierName]\r\n}\r\n\r\n// Register the modifier lookup function with the styler to break circular dependency\r\nsetModifierLookup(getModifier)\r\n\r\n// Extend the ChalkeeBase interface with modifier methods\r\ndeclare module './ChalkeeBase' {\r\n    interface ChalkeeBase {\r\n        // Modifiers\r\n        bold: Chalkee\r\n        dim: Chalkee\r\n        italic: Chalkee\r\n        underline: Chalkee\r\n        strikethrough: Chalkee\r\n        inverse: Chalkee\r\n        hidden: Chalkee\r\n\r\n        // Shorthand aliases\r\n        b: Chalkee // bold\r\n        d: Chalkee // dim\r\n        i: Chalkee // italic\r\n        u: Chalkee // underline\r\n        s: Chalkee // strikethrough\r\n        r: Chalkee // reset\r\n\r\n        // Special methods\r\n        hex: (color: string) => Chalkee\r\n        rgb: (r: number, g: number, b: number) => Chalkee\r\n        bgHex: (color: string) => Chalkee\r\n        bgRgb: (r: number, g: number, b: number) => Chalkee\r\n        bg: Chalkee // background mode\r\n        as: Chalkee // auto-spacing\r\n\r\n        // Reset\r\n        reset: Chalkee\r\n\r\n        // Utils methods\r\n        createBgMode(): Chalkee\r\n\r\n        // Callable-helpers methods\r\n        createColor(colorName: string, text?: string): Chalkee\r\n        createModifier(modifier: string): Chalkee\r\n    }\r\n}\r\n\r\n// Helper function to define modifier properties that create new instances\r\nconst defineModifierInstanceProperty = (name: string, creatorMethod: string) => {\r\n    Object.defineProperty(ChalkeeBase.prototype, name, {\r\n        get: function (this: Chalkee) {\r\n            // @ts-ignore\r\n            return this[creatorMethod](name)\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    })\r\n}\r\n\r\n// Helper function to define alias properties\r\nconst defineAliasProperty = (name: string, aliasedProperty: string) => {\r\n    Object.defineProperty(ChalkeeBase.prototype, name, {\r\n        get: function (this: Chalkee) {\r\n            // @ts-ignore\r\n            return this[aliasedProperty]\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    })\r\n}\r\n\r\n// Helper function to define special instance properties\r\nconst defineSpecialInstanceProperty = (name: string, creatorMethod: string) => {\r\n    Object.defineProperty(ChalkeeBase.prototype, name, {\r\n        get: function (this: Chalkee) {\r\n            // @ts-ignore\r\n            return this[creatorMethod]()\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    })\r\n}\r\n\r\n// Helper function to define value properties (methods that take parameters)\r\nconst defineValueProperty = (name: string, creatorMethod: string) => {\r\n    Object.defineProperty(ChalkeeBase.prototype, name, {\r\n        get: function (this: Chalkee) {\r\n            // @ts-ignore\r\n            return (...args: any[]) => this[creatorMethod](...args)\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    })\r\n}\r\n\r\n// Attach modifier methods to ChalkeeBase prototype\r\nfunction attachModifierMethods(ChalkeeBaseClass: typeof ChalkeeBase) {\r\n    // Core modifier methods\r\n    const modifiers = ['bold', 'dim', 'italic', 'underline', 'strikethrough', 'inverse', 'hidden']\r\n    for (const modifier of modifiers) {\r\n        defineModifierInstanceProperty(modifier, 'createModifier')\r\n    }\r\n\r\n    // Shorthand aliases\r\n    defineAliasProperty('b', 'bold')\r\n    defineAliasProperty('d', 'dim')\r\n    defineAliasProperty('i', 'italic')\r\n    defineAliasProperty('u', 'underline')\r\n    defineAliasProperty('s', 'strikethrough')\r\n\r\n    // Reset method\r\n    defineSpecialInstanceProperty('reset', 'createReset')\r\n    defineAliasProperty('r', 'reset')\r\n\r\n    // Special methods\r\n    defineSpecialInstanceProperty('as', 'createAutoSpacing')\r\n\r\n    // Background mode method with debug log (kept as explicit definition due to debug log)\r\n    Object.defineProperty(ChalkeeBase.prototype, 'bg', {\r\n        get: function (this: Chalkee) {\r\n            return this.createBgMode()\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    })\r\n\r\n    // Color methods that take parameters\r\n    defineValueProperty('hex', 'createHexColor')\r\n    defineValueProperty('rgb', 'createRgbColor')\r\n    defineValueProperty('bgHex', 'createBgHexColor')\r\n    defineValueProperty('bgRgb', 'createBgRgbColor')\r\n}\r\n\r\n// Automatically attach the methods when this module is imported\r\nattachModifierMethods(ChalkeeBase)\r\n\r\n// Create the empty state once and reuse it throughout the module\r\nconst emptyState = createStyleState()\r\n\r\n// Export modifier methods - reuse emptyState\r\n// @ts-ignore - bold, dim, etc. are augmented at runtime via module extension\r\nexport const bold = createStyledFunction('', emptyState).bold\r\nexport const dim = createStyledFunction('', emptyState).dim\r\nexport const italic = createStyledFunction('', emptyState).italic\r\nexport const underline = createStyledFunction('', emptyState).underline\r\nexport const strikethrough = createStyledFunction('', emptyState).strikethrough\r\nexport const inverse = createStyledFunction('', emptyState).inverse\r\nexport const hidden = createStyledFunction('', emptyState).hidden\r\nexport const reset = createStyledFunction('', emptyState).reset\r\n\r\n// Export shorthand aliases\r\nexport const b = createStyledFunction('', emptyState).b\r\nexport const d = createStyledFunction('', emptyState).d\r\nexport const i = createStyledFunction('', emptyState).i\r\nexport const u = createStyledFunction('', emptyState).u\r\nexport const s = createStyledFunction('', emptyState).s\r\nexport const r = createStyledFunction('', emptyState).r\r\n\r\n// Export special methods\r\nexport const as = createStyledFunction('', emptyState).as\r\nexport const bg = createStyledFunction('', emptyState).bg\r\n\r\n// Export hex and RGB methods\r\nexport const hex = createStyledFunction('', emptyState).hex\r\nexport const rgb = createStyledFunction('', emptyState).rgb\r\nexport const bgHex = createStyledFunction('', emptyState).bgHex\r\nexport const bgRgb = createStyledFunction('', emptyState).bgRgb\r\n"],"names":["ANSI_MODIFIERS","getModifier","modifierName","setModifierLookup","defineModifierInstanceProperty","name","creatorMethod","ChalkeeBase","defineAliasProperty","aliasedProperty","defineSpecialInstanceProperty","defineValueProperty","args","attachModifierMethods","ChalkeeBaseClass","modifiers","modifier","emptyState","createStyleState","bold","createStyledFunction","dim","italic","underline","strikethrough","inverse","hidden","reset","b","d","i","u","s","r","as","bg","hex","rgb","bgHex","bgRgb"],"mappings":"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"}